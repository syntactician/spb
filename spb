#!/usr/bin/env node

// const crpyto = require('crypto-js')

const fs = require('fs')
const https = require('http')
const minimist = require('minimist')
const request = require('request')

const argv = minimist(process.argv.slice(2))

const handler = (req, res) => {
  if (req.method === 'GET')
    handleGET(req, res)
  else
    console.error('Unsupported verb ' + req.method)
}

const handleGET = (req, res) => {
  const path = req.url

  if (path.startsWith('/assets/'))
    fs.createReadStream(path.slice(1)).pipe(res);
  else if (path === '/f')
    fs.createReadStream('form.html').pipe(res);
  else
    fs.createReadStream('index.html').pipe(res);
}

const main = () => https
  .createServer(handler)
  .listen(argv.p || 8000)

main()
